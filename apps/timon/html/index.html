<!doctype html>
<html lang="en">
<head>
	<link href="/lib/angular-ui/build/angular-ui.min.css" rel="stylesheet"/>
  <link href="/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<link rel="stylesheet/less" type="text/css" href="/components/toolbar/toolbar.less"/>
  <link rel="stylesheet/less" type="text/css" href="css/timon.less"/>
	<title>timon - tw-inspired microblog on indx</title>
</head>
<body ng-app="timon" ng-controller="main" ng-cloak>
  <div class="addFollowingModal modal fade" id="addFollowingModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title">add a follow:</h4>
        </div>
        <div class="modal-body">
          <h5><a href="" target="_blank">WebID</a> or channel URI:</h5>
          <input type="text" ng-model="new_following_url" placeholder='https://'></input>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" ng-click="(addFollowing(new_following_url) || true) && (new_following_url = '')">+ add following</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->  
  <div class="configModal modal fade" id="configModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
          <h4 class="modal-title">configure timon</h4>
        </div>
        <div class="modal-body">
          <div>
            <h5>display name:</h5>
            <input type="text" ng-model="config.displayname"></input>
          </div>
          <div>
            <h5>profile pic:</h5>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" ng-click="saveConfig(config)">Save</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->  
  <toolbar box-var='selected_box' username-var='userLoggedIn'></toolbar>
  <h1 ng-if="!userLoggedIn">please log in</h1>
  <div class="timonmain" ng-if="userLoggedIn">
    <div class="profilecard">
      <div class="identity">
        <div class="name">{{ name }}</div>
        <div class="configbtn btn glyphicon glyphicon-cog" data-toggle='modal' data-target='#configModal'></div>
        <div class="stats">following <div class="count">{{ _(following).pairs().length }}<span class="addbtn" data-toggle='modal' data-target='#addFollowingModal'>+</span></div></div>
        <div class="stats">followers <div class="count">{{ followers.length }}</div></div>
      </div>
      <div class="compose">
        <textarea class="newpostinput" ng-model="newpostinput.text" ng-focus='newfocus=true'></textarea>
        <div class="newpoststats" ng-if="newfocus">
          <div class="length">{{ 140 - newpostinput.text.length }}</div>
          <div class="submit btn btn-default" ng-disabled='newpostinput.text.trim().length === 0' ng-click="addPost(newpostinput.text) && (newpostinput.text = '')">post</div>
        </div>
      </div>
    </div>
    <div class="timeline">
      <h2>timeline</h2>
      <div class="timons">
        <tipost ng-repeat='t in timeline | orderObjectBy:"created":true' model="t"></tipost>
      </div>
    </div>
  </div>
  <script src="/lib/jquery/jquery.min.js" type="text/javascript"></script>
  <script src="/lib/less/dist/less-1.6.2.min.js" type="text/javascript"></script>
  <script src="/lib/underscore/underscore.js" type="text/javascript"></script>
  <script src="/lib/backbone/backbone.js" type="text/javascript"></script>
  <script src="/lib/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="/lib/angular/angular.min.js" type="text/javascript"></script>
  <script src="/js/indx.js" type="text/javascript"></script>
  <script src="/js/indx-ws.js" type="text/javascript"></script>
  <script src="/js/indx-channel.js" type="text/javascript"></script>
  <script src="/js/indx-utils.js" type="text/javascript"></script>
  <script src="/components/toolbar/toolbar.js" type="text/javascript"></script>
  <script src="js/timon.js" type="text/javascript"></script>
  <script src="js/tipost.js" type="text/javascript"></script>
</body>
</html>
